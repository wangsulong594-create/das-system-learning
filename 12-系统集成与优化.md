# DAS系统硬件详细分析：第十二部分 - 系统集成与优化

## 12. 硬件系统集成

### 12.1 完整的DAS系统架构

```
┌─────────────────────────────────────────────────────────────────┐
│                     DAS系统完整硬件架构                           │
└─────────────────────────────────────────────────────────────────┘

[光源单元]
    │
    ├─→ 窄线宽激光器 (1550 nm, 100 mW, <1 MHz线宽)
    │
    ↓
[光路处理单元]
    │
    ├─→ 50:50 光分路器 (分离本振光和探测光)
    │
    ├─→ 脉冲调制器 (AOM, 5 MHz 中心频率, 100 ns 脉冲)
    │   (产生 10 m 空间分辨率)
    │
    ├─→ 光放大器 (EDFA, +20 dB 增益)
    │
    ├─→ 环形器 (隔离 >40 dB)
    │
    └─→ 光纤传感链路 (10 km, 1000个通道 @ 10 m间距)

[信号接收单元]
    │
    ├─→ 90°光学混合器
    │
    ├─→ 平衡探测器 (I/Q 双通道, 1 GHz 带宽)
    │
    ├─→ 前置放大器 (可选, +20 dB)
    │
    └─→ 反混叠滤波器 (截止 40 MHz)

[采样与数字处理单元]
    │
    ├─→ ADC (100 MSPS, 12-bit, I/Q 双通道)
    │
    ├─→ FPGA (实时处理)
    │   ├─ 数字下变频 (DDC)
    │   ├─ 低通滤波
    │   ├─ 相位提取 (atan2)
    │   ├─ 相位展开
    │   └─ Gauge Length差分
    │
    └─→ 主机计算机 (CPU/GPU, 离线处理或后处理)

[存储与输出单元]
    │
    ├─→ 高速数据存储 (SSD, USB 3.0 or 以太网)
    │
    └─→ 数据接口 (以太网, 光纤, USB)
```

### 12.2 参数一致性要求

为了保证系统性能，各级参数必须协调。

#### 12.2.1 采样率与信号带宽的关系

**设计步骤**：

1. **确定振动信号最高频率**：$`f_{vib,max}`$
   - 地震：~100 Hz
   - 管道流量：~1 kHz
   - 高频振动：~10 kHz

2. **确定脉冲宽度**（由空间分辨率决定）：
   - 目标空间分辨率：$`\delta z = 10`$ m
   - 所需脉冲宽度：$`\tau = 2 n_{eff} \delta z / c \approx 100`$ ns

3. **脉冲的频谱带宽**：
   $`\Delta f = 0.44 / \tau = 0.44 / (100 \times 10^{-9}) = 4.4 \text{ MHz}`$

4. **总信号带宽**：
   $`BW_{total} = f_{vib,max} + \Delta f = 0.1 + 4.4 \approx 4.5 \text{ MHz}`$

5. **所需采样率**（留20%裕度）：
   $`f_s = 2.4 \times BW_{total} = 2.4 \times 4.5 = 10.8 \text{ MHz}`$
   
   取标准值 $f_s = 20$ MHz 或 $50$ MHz

#### 12.2.2 脉冲重复频率与光纤长度

已在第3部分推导：
$`f_{rep} < \frac{c}{2 L n_{eff}} = \frac{3 \times 10^8}{2 \times 10^4 \times 1.468} \approx 10.2 \text{ kHz}`$

**推荐**：$`f_{rep} = 5`$ kHz（保留50%裕度）

#### 12.2.3 噪声预算 (Noise Budget)

**总的系统噪声来自**：
1. **量子噪声** (shot noise): $\propto \sqrt{P_{optical}}$
2. **热噪声** (Johnson noise): $\propto \sqrt{T}$
3. **1/f噪声**: 低频漂移
4. **量化噪声** (ADC): 与ADC分辨率相关

**噪声功率总和**：
$$P_{noise,total} = P_{shot} + P_{thermal} + P_{quantization} + P_{1/f}$$

**信噪比目标**：
- 标准应用：SNR > 30 dB
- 高精度应用：SNR > 40 dB
- 极限应用（深海、极端环境）：SNR > 50 dB

### 12.3 性能优化

#### 12.3.1 光功率优化

**目标**：最大化干涉项功率，同时避免非线性效应

**约束条件**：
1. **避免光纤非线性**：
   - SBS（受激Brillouin散射）功率阈值：~20-100 W
   - SPM（自相位调制）：$`L_{eff} P / A_{eff} < 1`$ rad
   
2. **避免探测器饱和**：
   - 最大光电流：100-500 mA（取决于器件）

**优化策略**：
- 激光器功率：100-500 mW
- 本振光功率：50-200 mW
- 探测光功率：20-100 W（EDFA放大后）
- 平衡功率比（探测光vs本振光）：通常 2:1 to 10:1

#### 12.3.2 空间分辨率 vs 信噪比的权衡

**改善SNR的方法**：
1. **增加Gauge Length**：SNR $`\propto \sqrt{L_{GL}}`$
   - 缺点：空间分辨率降低
   
2. **增加EDFA增益**：
   - 增加光功率
   - 缺点：噪声（ASE）也增加，实际效果有限
   
3. **数据平均（空间或时间）**：
   - SNR $\propto \sqrt{N_{average}}$
   - 缺点：时间或空间分辨率降低

**推荐平衡**：
- 空间分辨率：10-50 m（对应Gauge Length 1-5倍脉冲宽度）
- 时间分辨率：1-100 ms（对应采样率 10-1000 Hz）
- SNR：30-40 dB

#### 12.3.3 温度补偿

光纤相位对温度敏感：$`d\phi/dT \approx 1-2`$ rad/°C

**补偿方法**：
1. **硬件补偿**：温度补偿光纤或相位补偿器
2. **软件补偿**：
   ```
   φ_corrected = φ_measured - α(T - T_ref)
   ```
   其中 $`\alpha \approx 1`$ rad/°C，需要温度传感器

**推荐**：采用软件补偿（成本低，灵活性高）

### 12.4 实时处理与数据管理

#### 12.4.1 数据速率计算

**原始数据速率**（已在第7部分计算）：
$`R_{raw} = N_{channels} \times f_s \times n_{bits} \times 2 = 300 \text{ GB/s}`$

**压缩后数据速率**（经过多级处理）：
$$R_{compressed} = 30 \text{ MB/s}$$
（压缩比：~10000:1）

#### 12.4.2 FPGA与CPU的分工

**FPGA负责**（实时，低延迟）：
- ✓ 数字下变频 (DDC)
- ✓ 低通滤波
- ✓ 相位提取
- ✓ 相位展开（基本）
- ✓ Gauge Length差分
- ✗ 不适合复杂算法

**CPU/GPU负责**（高通量，灵活）：
- ✓ 高级滤波（卡尔曼、自适应）
- ✓ 时频分析（小波、STFT）
- ✓ 事件检测
- ✓ 数据存储和索引

#### 12.4.3 存储策略

**原始数据**（可选保存）：
- 第一级：实时压缩（LZMA, GZIP）
- 第二级：有损压缩（丢弃高频噪声）
- 结果：压缩比 100:1

**处理后数据**（必须保存）：
- 格式：NetCDF 或 HDF5（科学计算标准格式）
- 采样率：降采样到 10-100 Hz（可以恢复高频）
- 存储成本：~30 MB/s → ~2.6 TB/day

### 12.5 系统指标总结

| 指标 | 值 | 单位 | 备注 |
|-----|------|------|------|
| **光学指标** | | | |
| 工作波长 | 1550 | nm | C波段 |
| 激光线宽 | <1 | MHz | 相干长度 >30 km |
| 输出功率 | 100-500 | mW | 可调 |
| **空间指标** | | | |
| 传感光纤长度 | 10 | km | 可扩展到 100+ km |
| 通道数 | 1000 | ch | 10 m 间距 |
| 空间分辨率 | 10 | m | 脉冲宽度 100 ns |
| **时间指标** | | | |
| 采样率 | 50-100 | MHz | 原始数据 |
| 时间分辨率 | 10-100 | μs | 采样间隔 |
| **性能指标** | | | |
| 应变灵敏度 | <1 | με | 微应变 |
| 速度分辨率 | <0.1 | mm/s | 粒子速度 |
| SNR | 30-40 | dB | 系统 |
| 动态范围 | 60-80 | dB | 应变范围 |
| **数据指标** | | | |
| 原始数据速率 | 300 | GB/s | ADC输出 |
| 压缩后速率 | 30 | MB/s | 处理后 |
| 单日存储 | 2.6 | TB | 连续采样 |
