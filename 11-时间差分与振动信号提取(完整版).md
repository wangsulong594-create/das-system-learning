# DAS系统硬件详细分析：第十一部分 - 时间差分与振动信号提取

## 11. 时间差分 (Temporal Differentiation)

### 11.1 概念

时间差分是指沿时间轴对相位（或应变）进行微分，用以提取振动速度和加速度信息。

**基本关系**：
$$v(z, t) = \frac{\partial u(z, t)}{\partial t}$$
$$a(z, t) = \frac{\partial v(z, t)}{\partial t} = \frac{\partial^2 u(z, t)}{\partial t^2}$$

其中：
- $u(z, t)$ = 位移
- $v(z, t)$ = 速度  
- $a(z, t)$ = 加速度

### 11.2 一阶时间差分（速度估计）

#### 11.2.1 后向差分
$$\dot{\varepsilon}_k(t_n) = \frac{\varepsilon_k(t_n) - \varepsilon_k(t_{n-1})}{\Delta t}$$

**精度**：一阶（误差～$`\Delta t`$）

#### 11.2.2 中心差分
$$\dot{\varepsilon}_k(t_n) = \frac{\varepsilon_k(t_{n+1}) - \varepsilon_k(t_{n-1})}{2\Delta t}$$

**精度**：二阶（误差～$`(\Delta t)^2`$）

#### 11.2.3 高阶中心差分
$$\dot{\varepsilon}_k(t_n) = \frac{-\varepsilon_k(t_{n+2}) + 8\varepsilon_k(t_{n+1}) - 8\varepsilon_k(t_{n-1}) + \varepsilon_k(t_{n-2})}{12\Delta t}$$

**精度**：四阶

### 11.3 二阶时间差分（加速度估计）

#### 11.3.1 中心差分
$$\ddot{\varepsilon}_k(t_n) = \frac{\varepsilon_k(t_{n+1}) - 2\varepsilon_k(t_n) + \varepsilon_k(t_{n-1})}{(\Delta t)^2}$$

#### 11.3.2 四阶精度
$$\ddot{\varepsilon}_k(t_n) = \frac{-\varepsilon_k(t_{n+2}) + 16\varepsilon_k(t_{n+1}) - 30\varepsilon_k(t_n) + 16\varepsilon_k(t_{n-1}) - \varepsilon_k(t_{n-2})}{12(\Delta t)^2}$$

### 11.4 时间差分的噪声特性

#### 11.4.1 频率域分析

**原始信号的功率谱**：$`S_\varepsilon(f)`$

**一阶导数的功率谱**：
$$S_{\dot{\varepsilon}}(f) = (2\pi f)^2 S_\varepsilon(f)$$

**二阶导数的功率谱**：
$$S_{\ddot{\varepsilon}}(f) = (2\pi f)^4 S_\varepsilon(f)$$

**关键观察**：高频噪声被放大 $(2\pi f)^2$ 倍或 $(2\pi f)^4$ 倍

#### 11.4.2 噪声放大与采样率

对于采样率 $f_s = 100$ MHz，Nyquist频率 $f_{Ny} = 50$ MHz：

**一阶导数噪声放大**：
$$\text{Amplification}_{1st} = (\pi f_s)^2 = (\pi \times 100 \times 10^6)^2 \approx 10^{17}$$

**必须进行低通滤波！**

### 11.5 低通滤波与时间差分结合

#### 11.5.1 先滤波后差分（推荐）

```
原始信号 → [低通滤波] → [时间差分] → 导数信号
```

**参数选择**：
- **截止频率**：$`f_c = 0.3 \times f_{signal,max}`$
- **滤波阶数**：5-8阶

#### 11.5.2 Butterworth微分滤波器

使用标准滤波设计工具（MATLAB的`butter`或`cheby1`）：

**参数**：
- **截止频率**：$`f_c = 0.2 \times f_{Nyquist}`$
- **滤波器类型**：高通（用于微分）+ 低通（防止噪声）
- **组合**：带通滤波器

### 11.6 完整的信号处理流程

```
原始相位 φ(z,t)
    ↓ [atan2]
应变 ε(z,t)
    ↓ [低通滤波 @ 0.3·f_max]
平滑应变
    ↓ [Gauge Length差分]
应变速率 ε_dot(z,t) ∝ 粒子速度
    ↓ [低通滤波 @ 0.2·f_max]
平滑应变速率
    ↓ [时间差分]
应变加速度 ε_ddot(z,t) ∝ 粒子加速度
```

### 11.7 单位转换

#### 11.7.1 相位 → 应变
$$\varepsilon [με] = \frac{\Delta\phi [rad]}{2\pi} \times 476$$

其中 $με$ 是微应变（$10^{-6}$应变）

#### 11.7.2 应变速率 → 粒子速度
$$v [m/s] = c_{eff} \times \dot{\varepsilon} [1/s]$$

其中 $c_{eff}$ 是等效声速（通常 5000-6000 m/s）

#### 11.7.3 应变加速度 → 粒子加速度
$$a [m/s^2] = c_{eff} \times \ddot{\varepsilon} [1/s^2]$$

---

## 总结表

| 参数 | 符号 | 单位 | 推荐值 | 说明 |
|-----|------|------|--------|------|
| 采样间隔 | $\Delta t$ | μs | 10-100 | $1/f_s$ |
| 差分精度 | - | 阶 | 2-4 | 中心差分或高阶 |
| 滤波截止频率 | $f_c$ | Hz | 0.2-0.3$f_{max}$ | 防止噪声 |
| 应变灵敏度 | - | με/rad | 476 | 1550 nm |
| 声速 | $c_{eff}$ | m/s | 5000-6000 | 岩石或土壤 |
| 滤波阶数 | N | - | 5-8 | IIR滤波器 |
